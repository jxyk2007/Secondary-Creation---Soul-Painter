# 🎨 灵魂画手 - AI视频二创工具 v1.0

一款专业的AI视频二创工具,自动识别视频中的搞笑场景并生成手绘风格插画,**支持多种AI平台,满足不同客户需求**。

## ✨ 功能特色

- 🎥 **多平台视频分析**: 支持 Ollama、Gemini、通义千问等多种AI平台
- 🔒 **本地运行模式**: Ollama完全离线运行,保护数据隐私,**无需API费用**
- 🤖 **智能场景识别**: AI驱动,自动识别视频中的搞笑/有趣时刻
- 🎨 **手绘风格转换**: 支持10+种AI平台生成手绘风格图片
- ⏱️ **精确视频插入**: 在对应时间点暂停原视频,插入手绘图
- 📐 **尺寸自适应**: 自动调整生成图片到原视频尺寸
- 🖥️ **现代化GUI**: 紧凑选项卡式界面,操作简单直观
- 📦 **批量处理**: 支持一次处理多个视频文件
- 🔄 **灵活切换**: 客户可自由选择AI平台和模型
- 🛡️ **智能容错**: API失败自动降级,确保功能可用

## 🚀 快速开始

### 方式1: 使用 Ollama 本地模式(推荐,免费)

**完全免费,无需API密钥,数据不上传云端!**

#### 1. 安装 Ollama
访问 https://ollama.com/download 下载并安装

#### 2. 下载视觉模型
```bash
ollama pull llava
```

#### 3. 启动软件
**Windows**: 双击 `start_gui.bat`

**或直接运行**:
```bash
python gui_main_compact.py
```

#### 4. 配置使用
1. 在"高级设置"选项卡选择**"Ollama本地模型"**
2. 选择视频文件
3. 点击"开始生成"

### 方式2: 使用云端API(需要API密钥)

支持平台: Gemini、通义千问、DeepSeek、Kimi等10+种AI平台

1. 获取对应平台的API密钥
2. 在"基础设置"中选择AI模式
3. 输入API密钥并测试连接
4. 开始处理视频

## 📋 系统要求

### 最低配置
- **操作系统**: Windows 10/11, macOS, Linux
- **Python**: 3.8+
- **内存**: 8GB
- **硬盘**: 10GB 可用空间
- **显存**: 4GB (使用Ollama llava)

### 推荐配置
- **CPU**: Intel i7 或同级
- **内存**: 16GB
- **显存**: 8GB+ (NVIDIA GPU)
- **硬盘**: SSD 20GB+

### 软件依赖
- Python 3.8+
- tkinter (内置)
- opencv-python
- requests
- FFmpeg (视频处理)
- Ollama (可选,本地模式需要)

## 🔧 安装说明

1. **安装Python依赖**
```bash
pip install -r requirements.txt
```

2. **(可选)安装Ollama本地模式**
```bash
# 访问 https://ollama.com/download 下载安装
# 然后下载视觉模型
ollama pull llava
```

3. **启动程序**
```bash
# Windows
start_gui.bat

# 或直接运行
python gui_main_compact.py
```

## 📖 文档

- [完整使用指南](GUI_COMPLETE_GUIDE.md) - 详细的GUI操作说明
- [Ollama使用指南](OLLAMA_USAGE.md) - Ollama配置和使用教程
- [配置文件说明](config.ini) - 所有配置选项详解

## 🎛️ 支持的AI平台

### 视频分析平台

| 平台 | 模式 | 特点 | 费用 |
|------|------|------|------|
| **Ollama** | ollama | 本地运行,隐私保护 | 免费 |
| **Google Gemini** | gemini | 云端分析,效果最佳 | 按量付费 |
| **通义千问** | qwen_video | 国内访问稳定 | 按量付费 |
| **自定义API** | frame_by_frame | 完全可控 | 自定义 |
| **模拟模式** | simulate | 快速测试 | 免费 |

### 图像生成平台

支持10+种AI平台:
- 通义千问 (qwen)
- Gemini (gemini)
- DeepSeek (deepseek)
- 月之暗面/Kimi (kimi)
- 智谱AI (zhipu)
- 百川智能 (baichuan)
- 01.AI (zeroone)
- OpenAI (openai)
- 自定义OpenAI兼容 (custom)
- 模拟模式 (simulate)

## 🛠️ 技术架构

### 核心模块

```
灵魂画手/
├── gui_main_compact.py          # 现代化GUI主界面
├── gui_workflow.py              # 工作流控制器
├── universal_video_analyzer.py  # 通用视频分析器(NEW)
├── universal_image_editor.py    # 通用图像编辑器
├── openai_compatible_image_editor.py  # OpenAI兼容接口
├── workflow.py                  # 核心工作流引擎
└── config.ini                   # 配置文件
```

### 技术特点

1. ✅ **多平台架构**: 工厂模式,轻松扩展新的AI平台
2. ✅ **本地+云端**: 支持完全本地运行或云端API
3. ✅ **智能容错**: 多级降级机制,确保功能可用
4. ✅ **精确插入**: 真正的时间点插入,非简单叠加
5. ✅ **批量处理**: 多线程,高效处理大量视频
6. ✅ **现代化GUI**: 选项卡式设计,操作直观
7. ✅ **尺寸自适应**: 自动匹配原视频分辨率

## 📊 性能参考

处理一个10分钟视频(抽帧间隔5秒):

| 模式 | 视频分析 | 图像生成 | 总耗时 |
|------|---------|---------|--------|
| Ollama(llava) | ~4分钟 | ~3分钟 | ~7分钟 |
| Ollama(llava:13b) | ~8分钟 | ~3分钟 | ~11分钟 |
| Gemini | ~1分钟 | ~3分钟 | ~4分钟 |
| 模拟模式 | 即时 | ~1分钟 | ~1分钟 |

## ❓ 常见问题

### Ollama 相关

**Q: "Ollama服务未响应"怎么办?**
```bash
# 检查服务是否运行
curl http://localhost:11434/api/tags

# Windows重启: 任务管理器结束Ollama.exe后重新打开
```

**Q: "模型未找到"?**
```bash
# 查看已安装模型
ollama list

# 下载模型
ollama pull llava
```

**Q: Ollama分析速度太慢?**
- 使用更小的模型(llava比llava:34b快很多)
- 增加抽帧间隔(5秒改为10秒)
- 升级硬件(使用GPU加速)

### API 相关

**Q: API连接失败?**
1. 检查API密钥是否正确
2. 点击"测试"按钮验证连接
3. 如果是Gemini,检查是否需要代理
4. 尝试切换到Ollama本地模式

**Q: 图像生成失败?**
- 查看日志输出的详细错误
- 验证API余额是否充足
- 尝试切换到其他AI平台

### 功能相关

**Q: 视频处理失败?**
- 确保视频文件未损坏
- 检查视频格式(支持mp4/avi/mov等)
- 查看workflow.log日志

**Q: 批量处理中某些视频失败?**
- 软件会跳过失败的继续处理
- 完成后显示失败文件列表
- 可单独重新处理失败的视频

**Q: 输出文件在哪里?**
- 默认目录: `./drafts`
- 点击"📁 打开输出"按钮自动打开
- 文件名: `hand_drawn_原文件名.mp4`

## 💼 商业部署

本工具支持商业使用,适合:

### 部署方案

**个人用户**:
- 推荐: Ollama本地模式
- 优势: 免费,隐私,离线

**专业用户**:
- 推荐: Ollama + 云端API混合
- 优势: 灵活切换,兼顾效果和成本

**企业客户**:
- 推荐: 自建推理服务
- 优势: 完全私有化,数据不出内网

### 定价建议

1. **免费版**: Ollama本地模式,无限制使用
2. **标准版**: 提供少量云端API额度
3. **专业版**: 更多API额度 + 技术支持
4. **企业版**: 无限使用 + 定制开发

## 🎊 版本信息

### v1.0 (2025-10-13)

**重大更新**:
- ✨ 新增 Ollama 本地视觉模型支持
- ✨ GUI 视频分析模式选择功能
- ✨ 支持多种 Ollama 视觉模型
- 🎨 优化界面为紧凑选项卡式设计
- 📦 批量处理功能
- 🔧 完善的错误处理和日志

**支持的AI平台**:
- 视频分析: Ollama, Gemini, 通义千问, 自定义, 模拟
- 图像生成: 10+ AI平台

**兼容性**: Windows 10/11, macOS, Linux | Python 3.8+

---

## 🎯 核心优势

✅ **多平台支持** - 客户可自由选择AI平台
✅ **本地运行** - Ollama模式完全离线,保护隐私
✅ **灵活定价** - 从免费到付费,满足不同需求
✅ **批量处理** - 提高工作效率
✅ **易于部署** - 简单配置即可使用

**这正是商业软件所需的灵活性! 🎊**

---

**让每个视频都有灵魂!祝生意兴隆!** 🎨✨💰
